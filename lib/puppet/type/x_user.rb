# Type: x_user
# Created: Mon Dec  5 12:19:52 PST 2011

Puppet::Type.newtype(:x_user) do
  @doc = "Manage Mac OS X DS Local user accounts
    
    $pbkdf2_hash = {
    	entropy => '2bd095a00221feddca14a5ae4abd32e41f5584b3db8bb069c84fd5398ec25b38d1de18312d13a712aba6b29107625df831816d63e49b41955ff215f3b684c55350654b3269f388daa8d840e3d893fdde12d8fa381a381c5a1ffc21b944c5fb6f85ad959f5d4caec45fdb4cf75e7ed8a259627f054594489b3ff511b48d85985e',
    	iterations => 33112,
    	salt => '799361bd54d1e249431f57721c9c0522611591470b5a8c134cd7ecddc3341304'
    }
  
    x_user { 'newuser':
      dslocal_node  => 'MyNode',
      realname      => 'New User'
      uid           => '301',
      shell         => '/bin/bash',
      gid           => '80',
      home          => '/private/var/newuser',
      password_sha1  => '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F380F7321199A8FF2FFF0FF75F7115444568F07F78A448FF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
      password_sha512 => '1ace666f79cc52d143a9b2f67a2bb2b320113c0c209bc30fd87508b1c4302d2394b0d58ab5e7bfcb92f6f7499a321f0ff93ef4c306d8e51b1026cd4e0ae243743074690f',
      password_sha512_pbkdf2 => $pbkdf2_hash,
      comment       => 'A local user.',
      ensure        => 'present'
    }"
      
  ensurable
  
  newparam(:name) do
    desc 'The name of the user record to manage.'
    isnamevar
  end

  newparam(:realname) do
    desc 'The name of the user record to manage.'
    defaultto { @resource[:name] }
  end

  newparam(:dslocal_node) do
    desc 'The name of the node to manage. Default is "Default".'
    defaultto 'Default'
  end

  newparam(:uid) do
    desc 'The numeric UID for the users account.'
  end

  newparam(:shell) do
    desc "The user's shell attribute."
  end

  newparam(:gid) do
    desc "The user's numeric GID attribute."
  end

  newparam(:home) do
    desc "Path to the user's home directory."
  end

  newparam(:password_sha1) do
    desc "The user's password stored as a shadow hash string."
  end

  newparam(:password_sha512) do
    desc "The user's password stored as a salted SHA512 hex digest."
  end

  newparam(:password_sha512_pbkdf2) do
    desc "The user's password stored as a Puppet hash containing: entropy, iterations, and salt."
  end

  newparam(:comment) do
    desc "Add a comment about this user."
  end
  
  
end
